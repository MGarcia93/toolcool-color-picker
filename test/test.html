<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Test Suite</title>
        <link rel="stylesheet" href="qunit-2.19.1.css" />
    </head>
    <body>
        <div id="qunit"></div>

        <div id="qunit-fixture">
            <toolcool-color-picker id="red" color="#ff0000"></toolcool-color-picker>
            <toolcool-color-picker id="black"></toolcool-color-picker>
            <toolcool-color-picker id="color-001aff" color="#001aff"></toolcool-color-picker>
            <toolcool-color-picker id="alpha-0-5" color="rgba(255, 255, 255, 0.5)"></toolcool-color-picker>
            <script src="../dist/toolcool-color-picker.min.js"></script>
        </div>

        <script src="qunit-2.19.1.js"></script>
        <script>
            QUnit.module('Color', () => {
                QUnit.test('initial color should be red', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    assert.equal($colorPicker.value, 'rgba(255, 0, 0, 1)');
                });

                QUnit.test('if initial color is not provided ---> it should be black', (assert) => {
                    const $colorPicker = document.querySelector('#black');
                    assert.equal($colorPicker.value, 'rgba(0, 0, 0, 1)');
                });

                QUnit.test('change color to #282e5c', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#282e5c';
                    assert.equal($colorPicker.value, 'rgba(40, 46, 92, 1)');
                });
            });

            QUnit.module('Popup', () => {
                QUnit.test('initial color should be red', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    assert.equal($colorPicker.value, 'rgba(255, 0, 0, 1)');
                });

                QUnit.test('if initial color is not provided ---> it should be black', (assert) => {
                    const $colorPicker = document.querySelector('#black');
                    assert.equal($colorPicker.value, 'rgba(0, 0, 0, 1)');
                });

                QUnit.test('color picker popup should be closed by default', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    assert.equal($colorPicker.opened, false);
                });

                QUnit.test('color picker popup element should not appear', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    assert.equal($popup, null);
                });

                QUnit.test('after "opened = true ---> color picker popup should be opened', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    assert.equal($colorPicker.opened, true);
                });

                QUnit.test('color picker popup element should appear', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    assert.notEqual($popup, null);
                });

                QUnit.test('when clicked outside popup should close', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    document.body.click();
                    assert.equal($colorPicker.opened, false);
                });

                QUnit.test('when clicked outside popup element should not appear', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    document.body.click();
                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    assert.equal($popup, null);
                });
            });

            QUnit.module('Saturation', () => {

                QUnit.test('when popup is opened ---> saturation element should exist', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    assert.notEqual($saturation, null);
                });

                QUnit.test('for red color saturation background should have 0 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(0, 100%, 50%)');
                });

                QUnit.test('for #001aff color saturation background should have 234 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#color-001aff');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(234, 100%, 50%)');
                });

                QUnit.test('for #001aff color saturation background should have 234 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#001aff';
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(234, 100%, 50%)');
                });

                QUnit.test('for #282e5c color saturation background should have 233 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#282e5c';
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(233, 100%, 50%)');
                });

                QUnit.test('for red color pointer left position should be 100%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const left = $pointer.style.left;

                    assert.equal(left, '100%');
                });

                QUnit.test('for red color pointer top position should be 0%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const top = $pointer.style.top;
                    assert.equal(top, '0%');
                });

                QUnit.test('for #7EC6A8 color pointer left position should be 36.36%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const left = $pointer.style.left;

                    assert.equal(left, '36.36%');
                });

                QUnit.test('for #7EC6A8 color pointer top position should be 22.35%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const top = $pointer.style.top;
                    assert.equal(top, '22.35%');
                });

                QUnit.test('for #0a010f color pointer left position should be 93.33%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#0a010f';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const left = $pointer.style.left;

                    assert.equal(left, '93.33%');
                });

                QUnit.test('for #0a010f color pointer top position should be 94.12%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#0a010f';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const top = $pointer.style.top;
                    assert.equal(top, '94.12%');
                });

                QUnit.test('pointer arrow left twice ---> left position has changed from 100% to 98%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '98%');
                });

                QUnit.test('pointer arrow left twice ---> top position has not changed', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '0%');
                });

                QUnit.test('pointer arrow right twice ---> left position has changed from 0% to 2%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#B1B1B1';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '2%');
                });

                QUnit.test('pointer arrow right twice ---> top position should not change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#B1B1B1';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '30.59%');
                });

                QUnit.test('pointer arrow up twice ---> top position should change from 30.59% to 28.59%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#B1B1B1';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowUp',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowUp',
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '28.59%');
                });

                QUnit.test('pointer arrow up twice ---> left position should not change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#B1B1B1';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowUp',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowUp',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '0%');
                });

                QUnit.test('pointer arrow down twice ---> top position should change from 30.59% to 32.59%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#B1B1B1';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowDown',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowDown',
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '32.59%');
                });

                QUnit.test('pointer arrow down twice ---> left position should not change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#B1B1B1';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowDown',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowDown',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '0%');
                });

                QUnit.test('pointer arrow right border case ---> left position should not change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '100%');
                });

                QUnit.test('pointer arrow up border case ---> top position should not change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowUp',
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '0%');
                });

                QUnit.test('pointer arrow left border case ---> left position should not change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#B1B1B1';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '0%');
                });

                QUnit.test('pointer arrow down border case ---> top position should not change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#000000';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowDown',
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '100%');
                });

                QUnit.test('pointer arrow left twice ---> color picker value should change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    assert.equal($colorPicker.value, 'rgba(255, 5, 5, 1)');
                });

                QUnit.test('when hsv has changed from outside to (79, 0.93, 0.06) ---> saturation bg color should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 79,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(79, 100%, 50%)');
                });

                QUnit.test('when hsv has changed from outside to (320, 0.93, 0.06) ---> saturation bg color should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 320,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(320, 100%, 50%)');
                });

                QUnit.test('when hsv has changed from outside to (320, 0.93, 0.06) ---> saturation bg color should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 360,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(360, 100%, 50%)');
                });

                QUnit.test('when hsv has changed from outside to (79, 0.93, 0.06) ---> pointer left position should be 93%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 79,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '93%');
                });

                QUnit.test('when hsv has changed from outside to (79, 0.93, 0.06) ---> pointer top position should be 94%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 79,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '94%');
                });

                QUnit.test('when hue has changed from outside to 79 ---> saturation bg color should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 79,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(79, 100%, 50%)');
                });

                QUnit.test('when hue has changed from outside to 200 ---> saturation bg color should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 200,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(200, 100%, 50%)');
                });

                QUnit.test('when hue has changed from outside to 79 ---> pointer left position should be 36.36%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 79,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '36.36%');
                });

                QUnit.test('when hue has changed from outside to 79 ---> pointer top position should be 22.35%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 79,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const top = $pointer.style.top;
                    assert.equal(top, '22.35%');
                });
            });

            QUnit.module('Hue', () => {

                QUnit.test('when popup is opened ---> hue element should exist', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    assert.notEqual($hue, null);
                });

                QUnit.test('for red color pointer left position should be 0%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, '0%');
                });

                QUnit.test('for initial #001aff color pointer left position should be 64.97%', (assert) => {
                    const $colorPicker = document.querySelector('#color-001aff');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, `64.97%`);
                });

                QUnit.test('after color change to #001aff ---> color pointer left position should be 64.97%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#001aff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, `64.97%`);
                });

                QUnit.test('after color change to #05FF00 ---> color pointer left position should be 33.01%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#05FF00';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, `33.01%`);
                });

                QUnit.test('pointer arrow left twice ---> left position has changed from 56.01% to 54.01%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '54.01%');
                });

                QUnit.test('pointer arrow right twice ---> left position has changed from 56.01% to 58.01%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '58.01%');
                });

                QUnit.test('pointer arrow left in red color ---> left position should remain 0%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '0%');
                });

                QUnit.test('pointer arrow right border case ---> left position should remain 100%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#FF000F';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '100%');
                });

                QUnit.test('pointer arrow left twice ---> color picker value should change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    assert.equal($colorPicker.value, 'rgba(0, 194, 255, 1)'); // 00C2FF
                });

                QUnit.test('pointer arrow right twice ---> color picker value should change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    assert.equal($colorPicker.value, 'rgba(0, 132, 255, 1)');
                });

                QUnit.test('when hsv has changed from outside to (79, 0.93, 0.06) ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 79,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '21.94%');
                });

                QUnit.test('when hsv has changed from outside to (320, 0.93, 0.06) ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 320,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '88.89%');
                });

                /*
                QUnit.test('when hue has changed from outside to 79 ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 79,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '21.94%');
                });

                QUnit.test('when hue has changed from outside to 320 ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 320,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '88.89%');
                });
                 */
            });

            QUnit.module('Alpha', () => {

                QUnit.test('when popup is opened ---> alpha element should exist', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $alpha = $popup.shadowRoot.querySelector('toolcool-color-picker-alpha');
                    assert.notEqual($alpha, null);
                });

                QUnit.test('for red with 100% opacity color pointer left position should be 100%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $alpha = $popup.shadowRoot.querySelector('toolcool-color-picker-alpha');
                    const $pointer = $alpha.shadowRoot.querySelector('.color-picker__alpha-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, '100%');
                });

                QUnit.test('for 50% opacity color pointer left position should be 50%', (assert) => {
                    const $colorPicker = document.querySelector('#alpha-0-5');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $alpha = $popup.shadowRoot.querySelector('toolcool-color-picker-alpha');
                    const $pointer = $alpha.shadowRoot.querySelector('.color-picker__alpha-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, '50%');
                });

                /*
                QUnit.test('for initial #001aff color pointer left position should be 64.97%', (assert) => {
                    const $colorPicker = document.querySelector('#color-001aff');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, `64.97%`);
                });

                QUnit.test('after color change to #001aff ---> color pointer left position should be 64.97%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#001aff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, `64.97%`);
                });

                QUnit.test('after color change to #05FF00 ---> color pointer left position should be 33.01%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#05FF00';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    const left = $pointer.style.left;
                    assert.equal(left, `33.01%`);
                });

                QUnit.test('pointer arrow left twice ---> left position has changed from 56.01% to 54.01%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '54.01%');
                });

                QUnit.test('pointer arrow right twice ---> left position has changed from 56.01% to 58.01%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '58.01%');
                });

                QUnit.test('pointer arrow left in red color ---> left position should remain 0%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '0%');
                });

                QUnit.test('pointer arrow right border case ---> left position should remain 100%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#FF000F';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '100%');
                });

                QUnit.test('pointer arrow left twice ---> color picker value should change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowLeft',
                    }));

                    assert.equal($colorPicker.value, 'rgba(0, 194, 255, 1)'); // 00C2FF
                });

                QUnit.test('pointer arrow right twice ---> color picker value should change', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#00A3FF';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    $pointer.dispatchEvent(new KeyboardEvent('keydown', {
                        view: window,
                        bubbles: true,
                        cancelable: true,
                        key: 'ArrowRight',
                    }));

                    assert.equal($colorPicker.value, 'rgba(0, 132, 255, 1)');
                });

                QUnit.test('when hsv has changed from outside to (79, 0.93, 0.06) ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 79,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '21.94%');
                });

                QUnit.test('when hsv has changed from outside to (320, 0.93, 0.06) ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hsv-changed', {
                        detail: {
                            h: 320,
                            s: 0.93,
                            v: 0.06,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '88.89%');
                });
                */
                /*
                QUnit.test('when hue has changed from outside to 79 ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 79,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '21.94%');
                });

                QUnit.test('when hue has changed from outside to 320 ---> pointer position should change too', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#fff';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $hue = $popup.shadowRoot.querySelector('toolcool-color-picker-hue');
                    const $pointer = $hue.shadowRoot.querySelector('.color-picker__hue-pointer-box');

                    document.dispatchEvent(new CustomEvent('toolcool-color-hue-changed', {
                        detail: {
                            h: 320,
                            cid: $colorPicker.cid,
                        }
                    }));

                    const left = $pointer.style.left;
                    assert.equal(left, '88.89%');
                });
                 */
            });

            // TODO: add API to get hsv, hex, etc. using tinycolor2
            // TODO: close on outer click causes bug when hovering outside without purpose
            // TODO: rename performUpdate to render, and shorten other names
            // TODO: try to tree shake tinycolor2
            // TODO: add eslint

            // TODO: alpha tests
            // TODO: fields tests
        </script>

    </body>
</html>
