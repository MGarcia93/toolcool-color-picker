<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Test Suite</title>
        <link rel="stylesheet" href="qunit-2.19.1.css" />
    </head>
    <body>
        <div id="qunit"></div>

        <div id="qunit-fixture">
            <toolcool-color-picker id="red" color="#ff0000"></toolcool-color-picker>
            <toolcool-color-picker id="black"></toolcool-color-picker>
            <toolcool-color-picker id="color-001aff" color="#001aff"></toolcool-color-picker>
            <script src="../public/lib/toolcool-color-picker.min.js"></script>
        </div>

        <script src="qunit-2.19.1.js"></script>
        <script>
            QUnit.module('Color', () => {
                QUnit.test('initial color should be red', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    assert.equal($colorPicker.value, 'rgba(255, 0, 0, 1)');
                });

                QUnit.test('if initial color is not provided ---> it should be black', (assert) => {
                    const $colorPicker = document.querySelector('#black');
                    assert.equal($colorPicker.value, 'rgba(0, 0, 0, 1)');
                });

                QUnit.test('change color to #282e5c', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#282e5c';
                    assert.equal($colorPicker.value, 'rgba(40, 46, 92, 1)');
                });
            });

            QUnit.module('Popup', () => {
                QUnit.test('initial color should be red', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    assert.equal($colorPicker.value, 'rgba(255, 0, 0, 1)');
                });

                QUnit.test('if initial color is not provided ---> it should be black', (assert) => {
                    const $colorPicker = document.querySelector('#black');
                    assert.equal($colorPicker.value, 'rgba(0, 0, 0, 1)');
                });

                QUnit.test('color picker popup should be closed by default', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    assert.equal($colorPicker.opened, false);
                });

                QUnit.test('color picker popup element should not appear', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    assert.equal($popup, null);
                });

                QUnit.test('after "opened = true ---> color picker popup should be opened', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    assert.equal($colorPicker.opened, true);
                });

                QUnit.test('color picker popup element should appear', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    assert.notEqual($popup, null);
                });

                QUnit.test('when clicked outside popup should close', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    document.body.click();
                    assert.equal($colorPicker.opened, false);
                });

                QUnit.test('when clicked outside popup element should not appear', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;
                    document.body.click();
                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    assert.equal($popup, null);
                });
            });

            QUnit.module('Saturation', () => {

                QUnit.test('when popup is opened ---> saturation element should exist', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    assert.notEqual($saturation, null);
                });

                QUnit.test('for red color saturation background should have 0 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(0, 100%, 50%)');
                });

                QUnit.test('for #001aff color saturation background should have 234 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#color-001aff');
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(234, 100%, 50%)');
                });

                QUnit.test('for #001aff color saturation background should have 234 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#001aff';
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(234, 100%, 50%)');
                });

                QUnit.test('for #282e5c color saturation background should have 233 saturation', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#282e5c';
                    $colorPicker.opened = true;

                    const $popup =  $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $saturationColor = $saturation.shadowRoot.querySelector('.color-picker__saturation-box');
                    const style = $saturationColor.getAttribute('style');
                    assert.equal(style, 'background: hsl(233, 100%, 50%)');
                });

                QUnit.test('for red color pointer left position should be 100%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const left = $pointer.style.left;

                    assert.equal(left, '100%');
                });

                QUnit.test('for red color pointer top position should be 0%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const top = $pointer.style.top;
                    assert.equal(top, '0%');
                });

                QUnit.test('for #7EC6A8 color pointer left position should be 36.36%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const left = $pointer.style.left;

                    assert.equal(left, '36.36%');
                });

                QUnit.test('for #7EC6A8 color pointer top position should be 22.35%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#7EC6A8';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const top = $pointer.style.top;
                    assert.equal(top, '22.35%');
                });

                QUnit.test('for #0a010f color pointer left position should be 93.33%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#0a010f';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const left = $pointer.style.left;

                    assert.equal(left, '93.33%');
                });

                QUnit.test('for #0a010f color pointer top position should be 94.12%', (assert) => {
                    const $colorPicker = document.querySelector('#red');
                    $colorPicker.value = '#0a010f';
                    $colorPicker.opened = true;

                    const $popup = $colorPicker.shadowRoot.querySelector('toolcool-color-picker-popup');
                    const $saturation = $popup.shadowRoot.querySelector('toolcool-color-picker-saturation');
                    const $pointer = $saturation.shadowRoot.querySelector('.color-picker__saturation-pointer');

                    const top = $pointer.style.top;
                    assert.equal(top, '94.12%');
                });

            });
        </script>

    </body>
</html>
